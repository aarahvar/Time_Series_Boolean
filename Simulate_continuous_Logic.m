

% TF(1).TF = sin(2*pi*(1:.05:4*pi));
% TF(2).TF = sin(2*pi*(1:.05:4*pi)+pi/4);
%
% TF(1).TF=[-0.43	-1.15	-0.92	-0.6	-0.74	-0.3	-0.29	-0.3	0.46	0.89	0.66	-0.1	-0.25	0.52	0.16	1.08	1.11	0.7	1.29	1.07	-1.15	-1.29	-0.84	-1.36	-0.1	0.21	-0.03	0.26	0.53	-0.17	-0.27	0	0.41	0.08	0.15	0.93	-0.58	-0.09	-0.42	0.19	0.11	-0.12	-0.04	0.16	-0.29	0.36	0.29	0.41	0.19	0.69	0.83	0.45	0.71	0.46	0.57	-0.09	0.7	0.08	0.58	0	-0.12	-0.94	0.96	1.11	0.99	0.14	-0.03	-0.14	0.59	0.33	0.34	-0.4	-0.49	-0.23	-0.23	0.03	0.04	-0.47	-1.22	0.04	0.25	-0.01	0.21	0.39	0.59	0.61	0.45	0.82	0.55	-0.15	-1.18	0.06	0.48	1	0.78	-0.06	-0.17	0.52	0.58	0.65	1.58	1.58	1.26	1.38	1.18	0.14	0.31	0.55	-0.18	-0.22	-0.45	0.24	0.63	1.1	0.33	1.39	1.04	0.93	1.49	1.04	1.68	0.34	0.43	0.84	1.16	1.29	1.44	0.99	1.02	1.2	0.75	-0.27	-0.76	-0.69	0.06	-0.47	-0.29	-0.54	-0.42	-0.56	-0.51	-0.58	-0.17	0.01	-0.046	-0.257	0.24	0.41	0.33	-0.22	0.33	0.38	0.12	1.17	0.38	0.79	0.2	0.4	0.62	0.4	0.61	0.4	0.34	0.58	-0.51	0.45	0.23	0.56	0.66	0.58	0.16	0.04	0.03];
% TF(2).TF= [0	-0.23	0.14	0.15	-0.14	-0.04	0.24	0.61	-0.01	0.08	-0.14	-0.07	0.25	0.04	0.06	0.03	0.24	-0.06	-0.15	-0.4	-0.07	0.44	0.54	0.4	0.43	-0.06	-0.04	-0.06	0.01	-0.12	0.23	-0.06	0.4	0.12	0.1	NaN	0.11	0.44	0.39	0.36	-0.09	NaN	NaN	NaN	NaN	NaN	0.57	0.28	0.19	0.12	0.04	0.24	0.21	-0.2	-0.92	-0.22	0.04	-0.58	-0.07	NaN	-0.49	-0.43	-0.32	0.26	0.03	0	0.15	0.25	-0.22	-0.15	0.03	0.32	0.29	0.49	0.14	-0.17	0.34	0.32	0.74	0.32	-0.25	-0.17	0.12	0.2	0.15	0.01	-0.15	-0.01	0.04	-0.38	1.07	0.75	0.34	0.88	0.82	1.03	1.07	1.04	0.93	1.12	1.37	1.6	1.33	1.82	1.55	-0.42	-0.07	0.07	-0.34	-0.54	0.64	-0.07	-0.2	-0.06	0.39	0.56	0.46	0.66	0.8	0.66	0.18	-0.36	0.15	NaN	NaN	0.26	0.56	0.73	0.85	-0.86	0.34	NaN	0.58	0.34	-0.12	0.5	-0.03	0.1	0.29	-0.27	-0.12	-0.01	0.14	-0.06	-0.061	-0.04	0.18	0.49	0.25	0.37	-0.06	0.3	0.33	0.46	-0.06	0.12	0.31	-0.34	0.34	-0.23	-0.01	-0.1	0	-0.29	-0.06	0.29	-0.54	0.1	-0.01	-0.04	0.71	0.21	0.57];
%
%
% TF(1).TF=[-0.12	-0.79	0.26	-1.15	-0.84	NaN	-0.22	NaN	0.42	0.24	0.19	-0.64	-0.3	-0.54	0.48	0.19	1.42	1.63	0.82	0.65	-1.09	-0.71	-1.03	-0.3	-0.43	1.12	0	0.16	-0.12	-0.4	-0.97	-0.14	-0.12	-0.38	0.52	-1.03	-0.81	-0.51	0.59	-0.34	-0.64	-0.36	-0.09	-0.54	-0.2	-0.06	-0.54	-0.32	-0.49	-0.2	0.26	-0.42	-0.4	0.18	-1.15	0.15	-0.47	NaN	NaN	-1.56	-1.29	0.06	0.37	0.06	-0.01	-0.03	-0.64	-0.64	0.21	-0.34	-0.86	-0.89	-1.06	-0.58	-0.62	-0.49	-0.36	-0.01	-0.29	-0.49	-0.45	-0.04	-0.25	-0.32	0.28	0.43	0.6	0.74	0.7	0.24	-0.71	-0.64	-0.42	-0.29	-0.2	-0.07	-0.54	-0.22	0.16	-0.07	-0.79	-0.56	-0.51	-0.54	-0.32	-0.29	-0.27	-0.51	-0.81	-0.71	-2.12	-1.03	-0.43	-0.54	-1.29	-0.69	-0.64	-1.47	-1.51	-0.86	-0.62	-1.69	0.08	-0.76	-1.06	-1.03	-0.86	-0.81	-1.12	-0.2	NaN	NaN	-0.42	0.15	-0.51	-0.38	-0.76	-0.51	0.16	-1.03	0.43	-0.38	-1.15	0.28	0.061	0.285	-1.32	-0.29	0.7	0.33	0.38	0.54	0.54	-0.64	0.1	0.44	-0.54	0.66	-1.25	-0.58	-0.22	-0.1	0.26	-0.04	-0.45	0.08	-0.51	0.12	0.16	0.31	0.24	-0.34	-0.32];
% TF(2).TF=[-0.01	0.26	0.23	0.24	-0.4	-0.22	-0.18	-0.1	0.01	-0.38	-0.23	-0.03	0.39	-0.29	0.01	0.5	0.43	0.54	0.15	0.54	-0.23	0.75	0.69	-0.09	0.19	0.6	0.26	0.4	0.11	0.33	0.44	0.01	0.72	-0.04	0.28	0.7	0.34	0.41	0.32	0.36	0.16	-0.29	-0.06	-0.32	-0.6	0	0.32	0.2	-0.01	-0.07	0.15	0.08	0.15	0.31	0.11	0.1	0.33	-0.49	0.11	-0.1	-0.22	-0.01	0.14	0.33	-0.01	0.41	0.06	0.16	-0.1	-0.01	-0.03	-0.06	-0.15	0.07	-0.43	-0.36	-0.23	-0.18	0.1	-0.12	-0.1	-0.36	-0.04	0.1	0.38	0.24	0.08	0.31	0.21	0.24	-0.22	-0.42	-0.74	-0.38	-0.29	-0.01	-0.1	-0.2	-0.27	0	-0.12	-0.27	-0.29	0.12	0.1	-0.2	-0.43	-0.23	-0.25	-0.29	0.14	-0.71	-0.14	-0.45	0.24	-0.64	-0.07	-0.45	-0.2	-0.47	-1.51	-1.56	-0.22	-0.01	0.58	0.52	-0.3	-0.32	-0.04	-0.54	-1.69	NaN	-2	-1.94	0.44	0.45	0.18	-0.15	0.04	-0.27	0.46	0.4	-0.03	0.85	-0.124	0.236	0.58	-0.12	0.37	0.01	0.31	0.14	0.08	0.24	0.04	0.39	0.4	0.45	0.65	0.11	0.32	0.07	-0.07	-0.06	-0.38	0.7	-0.01	0.33	0.36	-0.2	-0.03	-0.06	0.04];
%

if ~exist('Gene')
    load('Gene');
end
TF(1).TF = Gene.E2F1.Value(1,42:108)';
%TF(2).TF = Gene.CCNF.Value(42:108)';
TF(2).TF = Gene.CCNA2.Value(42:108)';

TF(1).TF(48)=[];
TF(2).TF(48)=[];
t1 = 0:46;
t2 = 0:2:36;

timespan = [0:46 48:2:84];

% TF(1).TF = Gene.E2F1.Value(1,42:88)';
% TF(2).TF = Gene.CCNF.Value(42:88)';
% % TF(2).TF = Gene.CCNA2.Value(42:88)';
% t1 = 0:46;




Anti_Log = 1  ;
Use_Smoothed_Curve = 1  ;
normalized_hill_flag = 0;
Normalize_Input_Flag = 1;
Use_Hill_Flag = 1;
Plot_Hill_Mesh_Flag = 0;
Logic_Output = [1 0 1 0];

n= 4   ;
k=.5;
abs_flag = 1;

Y0=(.6*rand-.3)+.5;
tau = 8   ;


windowSize = 2;
Range_divider_thr = 40;
shift =0 ;
Num_TF = length(TF);

plot_ts_flag = 1;


[T_b,TF_d,TF_s,TF_b,y_out] = Generate_Target_ts(TF,Logic_Output,Y0,timespan,windowSize,...
    Range_divider_thr,Use_Smoothed_Curve,Anti_Log,plot_ts_flag,Plot_Hill_Mesh_Flag,Use_Hill_Flag,normalized_hill_flag,n,k,tau,abs_flag,Normalize_Input_Flag);




% if shift
%     [T_d,~] = up_discretize([zeros(shift,1);T(1:end-shift+1)],windowSize,Range_divider_thr);
% else
%     [T_d,~] = up_discretize([T;0],windowSize,Range_divider_thr);
% end

% [TF_d1,~] = discretize_thr(TF(1).TF,windowSize,Range_divider_thr);
% [TF_d2,~] = discretize_thr(TF(2).TF,windowSize,Range_divider_thr);
% [T_d,~] = discretize_thr(T,windowSize,Range_divider_thr);


% plot((TF1_b & TF2_b)*2-1,'g')

clc
%00
ind = find(~TF_b(1).TF_b & ~TF_b(2).TF_b);
count00=hist(T_b(ind'),[0 1]);
display(['00: ' num2str(count00)]);
%01
ind = find(~TF_b(1).TF_b & TF_b(2).TF_b);
count01=hist(T_b(ind'),[0 1]);
display(['01: ' num2str(count01)]);


%10
ind = find(TF_b(1).TF_b & ~TF_b(2).TF_b);
count10=hist(T_b(ind'),[0 1]);
display(['10: ' num2str(count10)]);


%11
ind = find(TF_b(1).TF_b & TF_b(2).TF_b);
count11=hist(T_b(ind'),[0 1]);
display(['11: ' num2str(count11)]);

display('***************************')
[~,out_11] = max(count11);
out_11 = out_11-1;
[~,out_10] = max(count10);
out_10 = out_10-1;
[~,out_01] = max(count01);
out_01 = out_01-1;
[~,out_00] = max(count00);
out_00 = out_00-1;


Logic_Output
display(['00: ' num2str(out_00)]);
display(['01: ' num2str(out_01)]);
display(['10: ' num2str(out_10)]);
display(['11: ' num2str(out_11)]);
